---
import { getCollection } from "astro:content";
import GameItem from "../../components/GameItem.astro";

const games = (await getCollection("games")).map((item) => {
    const baseId = item.id.split("/")[0];
    const basePath = item.filePath.replace(/\/[^/]+$/, ""); // removes last path segment

    return {
        id: baseId,
        data: item.data,
        filePath: basePath,
    };
});
---

<canvas id="background"></canvas>
<h1>Heres my games ive made, enjoy :3</h1>
<div id="games">
    {
        games.map((game) => (
            <div>
                <GameItem game={game} />
            </div>
        ))
    }
</div>

<style>
    html,
    body {
        margin: 0;
        height: 100%;
    }
    #background {
        width: 100%;
        height: 100%;
        position: absolute;
        pointer-events: none;
        z-index: -1000;
    }
    #games {
        display: flex;
        gap: 80px;
    }

    #games > div {
        max-width: 300px;
    }
</style>

<script src="../../scripts/funky-background/main.ts"></script>
